<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AGWSim - Interactive MODS AGW Simulator Agent: agwutils.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AGWSim - Interactive MODS AGW Simulator Agent
   &#160;<span id="projectnumber">Version 0.2.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">agwutils.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>MODS AGW Stage Utility Functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;../include/client.h&quot;</code><br />
<code>#include &quot;../include/agwutils.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abcfb6b61ede9530fb677d4bc633bba17"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#abcfb6b61ede9530fb677d4bc633bba17">mlcBitsBase10</a> (int, char[], char[])</td></tr>
<tr class="memdesc:abcfb6b61ede9530fb677d4bc633bba17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check mechanism IO bits.  <a href="agwutils_8c.html#abcfb6b61ede9530fb677d4bc633bba17">More...</a><br /></td></tr>
<tr class="separator:abcfb6b61ede9530fb677d4bc633bba17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a745289639cbba9a189d5c29c2e535e36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#a745289639cbba9a189d5c29c2e535e36">agwIsLocked</a> (agwpar_t *<a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>, char *reply)</td></tr>
<tr class="memdesc:a745289639cbba9a189d5c29c2e535e36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the AGW lock status.  <a href="agwutils_8c.html#a745289639cbba9a189d5c29c2e535e36">More...</a><br /></td></tr>
<tr class="separator:a745289639cbba9a189d5c29c2e535e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e247187f3932c11b83dbc1220ca52c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#a65e247187f3932c11b83dbc1220ca52c">agwInitConfig</a> (agwpar_t *<a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>)</td></tr>
<tr class="memdesc:a65e247187f3932c11b83dbc1220ca52c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the AGW stage runtime parameters.  <a href="agwutils_8c.html#a65e247187f3932c11b83dbc1220ca52c">More...</a><br /></td></tr>
<tr class="separator:a65e247187f3932c11b83dbc1220ca52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5cd337a35756de555e9991bcd431f91"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#af5cd337a35756de555e9991bcd431f91">agwFocus</a> (double xGP, double yGP)</td></tr>
<tr class="memdesc:af5cd337a35756de555e9991bcd431f91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the focus offset at any given guide probe field position.  <a href="agwutils_8c.html#af5cd337a35756de555e9991bcd431f91">More...</a><br /></td></tr>
<tr class="separator:af5cd337a35756de555e9991bcd431f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11254e4de6145cd4e6e563ca709d85ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#a11254e4de6145cd4e6e563ca709d85ea">gpToAGW</a> (agwpar_t *<a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>, double xgp, double ygp, double *xs, double *ys, double *foc)</td></tr>
<tr class="memdesc:a11254e4de6145cd4e6e563ca709d85ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform Guide Probe (xGP,yGP) to AGW stage (Xs,Ys,Focus)  <a href="agwutils_8c.html#a11254e4de6145cd4e6e563ca709d85ea">More...</a><br /></td></tr>
<tr class="separator:a11254e4de6145cd4e6e563ca709d85ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aae70ba43d838257df2d6b9b74e525f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#a7aae70ba43d838257df2d6b9b74e525f">agwToGP</a> (agwpar_t *<a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>, double xs, double ys, double foc, double *xgp, double *ygp)</td></tr>
<tr class="memdesc:a7aae70ba43d838257df2d6b9b74e525f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform AGW stage (Xs,Ys,Focus) to Guide Probe (xGP,yGP)  <a href="agwutils_8c.html#a7aae70ba43d838257df2d6b9b74e525f">More...</a><br /></td></tr>
<tr class="separator:a7aae70ba43d838257df2d6b9b74e525f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55b6ac0f3b36c823394d57af4fd7c56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="agwutils_8c.html#ad55b6ac0f3b36c823394d57af4fd7c56">agwGetPos</a> (agwpar_t *<a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>)</td></tr>
<tr class="memdesc:ad55b6ac0f3b36c823394d57af4fd7c56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query the mechanisms and update the device position data members.  <a href="agwutils_8c.html#ad55b6ac0f3b36c823394d57af4fd7c56">More...</a><br /></td></tr>
<tr class="separator:ad55b6ac0f3b36c823394d57af4fd7c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MODS AGW Stage Utility Functions. </p>
<p>This module contains utility functions used by the MODS AGW stage control system.</p>
<dl class="section author"><dt>Author</dt><dd>R. Pogge, OSU Astronomy Dept. (<a href="#" onclick="location.href='mai'+'lto:'+'pog'+'ge'+'@as'+'tr'+'ono'+'my'+'.oh'+'io'+'-st'+'at'+'e.e'+'du'; return false;">pogge<span style="display: none;">.nosp@m.</span>@ast<span style="display: none;">.nosp@m.</span>ronom<span style="display: none;">.nosp@m.</span>y.oh<span style="display: none;">.nosp@m.</span>io-st<span style="display: none;">.nosp@m.</span>ate.<span style="display: none;">.nosp@m.</span>edu</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2006 Jan 12</dd></dl>
<dl class="section user"><dt>Modification History:</dt><dd><pre>
   2008 Jan 27 - various changes for the actual AGW stage system 
                 and the simulation modes [rwp/osu]
   2008 Aug 19 - overhauled to update transformations and remove 
                 the simulation mode [rwp/osu]
   2009 Oct 24 - modifications while testing the LBT GCS interface [rdg &amp; rwp/osu]
   2010 Mar 10 - replace <a class="el" href="mlc_8c.html#a5b636f740db1c9123a707e4468d39a3a" title="Send a command to a mechanism.">sendCommand()</a>; with mlcBase10Bits(); for filterwheel[rdg]
   2011 Mar 19 - modify <a class="el" href="agwutils_8c.html#af5cd337a35756de555e9991bcd431f91" title="Compute the focus offset at any given guide probe field position.">agwFocus()</a> to compute focus at the location of the WFS
                 hotspot [rwp/osu]
</pre> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abcfb6b61ede9530fb677d4bc633bba17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcfb6b61ede9530fb677d4bc633bba17">&#9670;&nbsp;</a></span>mlcBitsBase10()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mlcBitsBase10 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>cmd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>dummy</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check mechanism IO bits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>index of the mechanism </td></tr>
    <tr><td class="paramname">cmd</td><td>IO bit string to convert </td></tr>
    <tr><td class="paramname">dummy</td><td>string to contain reply if error</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of the bits in base 10</dd></dl>
<p>Queries the named mechanism for bit value</p>
<pre>
  Bits 1 - 6 IO 20, and IO 30
</pre> 
<p class="reference">References <a class="el" href="mlc_8c.html#aa8d176f0b4f700f1ddca7513acbaff4b">atobase()</a>, and <a class="el" href="mlc_8c.html#a1d034619776a6bad8728b24b7f6d6eb9">rawCommand()</a>.</p>

<p class="reference">Referenced by <a class="el" href="commands_8c.html#a1429620bfd12180699a5cbb00ec49afb">cmd_filter()</a>, <a class="el" href="commands_8c.html#af135627181e5fb68c2cc30fb891bd6c4">cmd_getpos()</a>, <a class="el" href="commands_8c.html#ae9ef1b5fbf25715cc45fc7906b05f615">cmd_home()</a>, <a class="el" href="commands_8c.html#a33a94b4c1ae07bd8270d4b0e1b633196">cmd_init()</a>, <a class="el" href="commands_8c.html#aee9ff4b934d75a8e7d7d460724e54580">cmd_reset()</a>, <a class="el" href="commands_8c.html#a8d1221a3a5afcbf2b18a5c4da66a3f84">cmd_setpos()</a>, <a class="el" href="commands_8c.html#a7344d7ca398862ff787b6fdc16146641">cmd_xy()</a>, and <a class="el" href="mlc_8c.html#a03f212b0e56912623dd6839d4373c34b">mlcLimitBits()</a>.</p>

</div>
</div>
<a id="a745289639cbba9a189d5c29c2e535e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a745289639cbba9a189d5c29c2e535e36">&#9670;&nbsp;</a></span>agwIsLocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int agwIsLocked </td>
          <td>(</td>
          <td class="paramtype">agwpar_t *&#160;</td>
          <td class="paramname"><em>agw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>reply</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the AGW lock status. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">agw</td><td>pointer to an agwpar_t struct for this AGW instance </td></tr>
    <tr><td class="paramname">reply</td><td>string to contain any command return reply </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the AGW is locked against this host, 0 if the AGW is either (a) not locked or (b) host is the lock holder. The reply string contains an error message if the host is locked out.</dd></dl>
<p>Tests the status of the AGW command lock. If the lock is not set, it returns 0, allowing the action function (usually in command.c) to proceed. If the lock is asserted, it tests the cmdHost against lockHost. If cmdHost is the lockHost it returns 0 ("OK to proceed"), otherwise it returns 1 ("device is locked out").</p>
<p>Allowance for executive override must be tested in the calling routine. </p>

<p class="reference">References <a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>.</p>

<p class="reference">Referenced by <a class="el" href="commands_8c.html#a43b886d0c43ad55c74421fa5a29fb212">cmd_autofoc()</a>, <a class="el" href="commands_8c.html#afad782c4abb40b72bc45da5fed0cdd93">cmd_center()</a>, <a class="el" href="commands_8c.html#ad0b8d9f87ecb2a7dec2e1154b86fc0d7">cmd_drift()</a>, <a class="el" href="commands_8c.html#a9683258ca76ad15446d45def8ffadb17">cmd_driftvec()</a>, <a class="el" href="commands_8c.html#a1429620bfd12180699a5cbb00ec49afb">cmd_filter()</a>, <a class="el" href="commands_8c.html#ac054c29585178a1cb24aa710ac838389">cmd_focus()</a>, <a class="el" href="commands_8c.html#a20fc57396c588a2a263d9e2ea59ed25f">cmd_foffset()</a>, <a class="el" href="commands_8c.html#ae9ef1b5fbf25715cc45fc7906b05f615">cmd_home()</a>, <a class="el" href="commands_8c.html#a8d1221a3a5afcbf2b18a5c4da66a3f84">cmd_setpos()</a>, and <a class="el" href="commands_8c.html#a7344d7ca398862ff787b6fdc16146641">cmd_xy()</a>.</p>

</div>
</div>
<a id="a65e247187f3932c11b83dbc1220ca52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65e247187f3932c11b83dbc1220ca52c">&#9670;&nbsp;</a></span>agwInitConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agwInitConfig </td>
          <td>(</td>
          <td class="paramtype">agwpar_t *&#160;</td>
          <td class="paramname"><em>agw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the AGW stage runtime parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">agw</td><td>pointer to the agwpar_t struct to initialize</td></tr>
  </table>
  </dd>
</dl>
<p>Initializes the AGW stage configuration data structure to sensible default values. </p>

<p class="reference">References <a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>, and <a class="el" href="agwutils_8c.html#a7aae70ba43d838257df2d6b9b74e525f">agwToGP()</a>.</p>

<p class="reference">Referenced by <a class="el" href="loadconfig_8c.html#a467636df2b3c34a333a8c9a73ddc4fd0">LoadConfig()</a>.</p>

</div>
</div>
<a id="af5cd337a35756de555e9991bcd431f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5cd337a35756de555e9991bcd431f91">&#9670;&nbsp;</a></span>agwFocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double agwFocus </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xGP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>yGP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the focus offset at any given guide probe field position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xGP</td><td>X-axis location of the guide probe center in millimeters </td></tr>
    <tr><td class="paramname">yGP</td><td>Y-axis location of the guide probe center in millimeters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The focus value in millimeters from the focus home position</dd></dl>
<p>The LBT f/15 Direct Gregorian focus has a convex spherical focal surface with the tangent point located at the center of the MODS science field. The radius of curvature of this surface is defined by #AGW_FRADIUS in millimeters.</p>
<p>For any given guide probe position relative to the science field center, this routine computes the nominal focus offset.</p>
<p>Note that this routine just does the formal calculation of the focus surface, it does not validate the computed offset against the permitted range of motion of the focus mechanism. That is the ultimate responsibility of the calling routine.</p>
<p>Because the WFS pickoff is not located at the center of the guider field-of-view, we need to compute the focus at the location of the WFS "hotspot", which is defined in the .ini file by the WFSXOffset and WFSYOffset parameters. This offset must be measured for each AGw unit, and can change when the AGw units are serviced.</p>
<p>The telescope active optics is sensitive enough to see the focus difference. For example, for a WFS Y-offset of 13.5mm relative to the center of the guide camera, at Y=4-arcmin from the science field center the focus shift is -1.8mm, corresponding to -298nm of Z4 shift (focus Zernike term). This is readily measurable by the LBT active optics system.</p>
<p>This change was instituted on 2011 March 19 [rwp/osu] </p>

<p class="reference">References <a class="el" href="agwServer_8c.html#a846fac061118f26e08912f8c4f10f863">appAGW</a>.</p>

<p class="reference">Referenced by <a class="el" href="agwutils_8c.html#a11254e4de6145cd4e6e563ca709d85ea">gpToAGW()</a>.</p>

</div>
</div>
<a id="a11254e4de6145cd4e6e563ca709d85ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11254e4de6145cd4e6e563ca709d85ea">&#9670;&nbsp;</a></span>gpToAGW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpToAGW </td>
          <td>(</td>
          <td class="paramtype">agwpar_t *&#160;</td>
          <td class="paramname"><em>agw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xgp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ygp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>foc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transform Guide Probe (xGP,yGP) to AGW stage (Xs,Ys,Focus) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">agw</td><td>Pointer to an AGW stage data structure </td></tr>
    <tr><td class="paramname">xgp</td><td>Guide Probe X coordinate relative to science field center [mm] </td></tr>
    <tr><td class="paramname">ygp</td><td>Guide Probe Y coordinate relative to science field center [mm] </td></tr>
    <tr><td class="paramname">xs</td><td>AGW stage X position relative to home [mm] </td></tr>
    <tr><td class="paramname">ys</td><td>AGW stage Y position relative to home [mm] </td></tr>
    <tr><td class="paramname">foc</td><td>AGW stage focus probe position relative to home [mm]</td></tr>
  </table>
  </dd>
</dl>
<p>For the AGW stage, home is defined as the mechanism driven to its mechanical home position sensor.</p>
<p>The X stage position is just the requested X probe position relative to the calibrated X stage position of the field center.</p>
<p>The Y stage position transformation includes the calibrated Y stage position of the field center and the position of the focus actuator, which is colinear with the Y stage motion. The focal surface of the LBT f/15 direct Gregorian focus is spherical, and computed using <a class="el" href="agwutils_8c.html#af5cd337a35756de555e9991bcd431f91" title="Compute the focus offset at any given guide probe field position.">agwFocus()</a>. At each Y position, we compute the focus offset associated with that position, and then offset the Y stage that amount to put the guide probe field center at that position, with that focus.</p>
<p>If autoFocus is disabled, it uses the current focus position. In normal operation we expect autoFocus to always be enabled.</p>
<p>Complicated, but it works.</p>
<p>For the reverse transformation, see <a class="el" href="agwutils_8c.html#a7aae70ba43d838257df2d6b9b74e525f" title="Transform AGW stage (Xs,Ys,Focus) to Guide Probe (xGP,yGP)">agwToGP()</a> </p>

<p class="reference">References <a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>, and <a class="el" href="agwutils_8c.html#af5cd337a35756de555e9991bcd431f91">agwFocus()</a>.</p>

<p class="reference">Referenced by <a class="el" href="commands_8c.html#afad782c4abb40b72bc45da5fed0cdd93">cmd_center()</a>, and <a class="el" href="commands_8c.html#a7344d7ca398862ff787b6fdc16146641">cmd_xy()</a>.</p>

</div>
</div>
<a id="a7aae70ba43d838257df2d6b9b74e525f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aae70ba43d838257df2d6b9b74e525f">&#9670;&nbsp;</a></span>agwToGP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agwToGP </td>
          <td>(</td>
          <td class="paramtype">agwpar_t *&#160;</td>
          <td class="paramname"><em>agw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>foc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xgp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ygp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transform AGW stage (Xs,Ys,Focus) to Guide Probe (xGP,yGP) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">agw</td><td>Pointer to an AGW stage data structure </td></tr>
    <tr><td class="paramname">xs</td><td>AGW stage X position relative to home [mm] </td></tr>
    <tr><td class="paramname">ys</td><td>AGW stage Y position relative to home [mm] </td></tr>
    <tr><td class="paramname">foc</td><td>AGW stage focus probe position relative to home [mm] </td></tr>
    <tr><td class="paramname">xgp</td><td>Guide Probe X coordinate relative to science field center [mm] </td></tr>
    <tr><td class="paramname">ygp</td><td>Guide Probe Y coordinate relative to science field center [mm]</td></tr>
  </table>
  </dd>
</dl>
<p>Transforms the AGW stage position defined by the triplet (Xs,Ys,Focus) into the location of the guide probe field center (xGP,yGP) relative to the defined center of the science field.</p>
<p>For the reverse transformation, see <a class="el" href="agwutils_8c.html#a11254e4de6145cd4e6e563ca709d85ea" title="Transform Guide Probe (xGP,yGP) to AGW stage (Xs,Ys,Focus)">gpToAGW()</a> </p>

<p class="reference">References <a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>.</p>

<p class="reference">Referenced by <a class="el" href="agwutils_8c.html#ad55b6ac0f3b36c823394d57af4fd7c56">agwGetPos()</a>, and <a class="el" href="agwutils_8c.html#a65e247187f3932c11b83dbc1220ca52c">agwInitConfig()</a>.</p>

</div>
</div>
<a id="ad55b6ac0f3b36c823394d57af4fd7c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad55b6ac0f3b36c823394d57af4fd7c56">&#9670;&nbsp;</a></span>agwGetPos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agwGetPos </td>
          <td>(</td>
          <td class="paramtype">agwpar_t *&#160;</td>
          <td class="paramname"><em>agw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query the mechanisms and update the device position data members. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">agw</td><td>Pointer to an AGW stage data structure</td></tr>
  </table>
  </dd>
</dl>
<p>Queries the AGW stage mechanisms and updates the current coordinates of the stage, guide probe center, and WFS pickoff center. The origin of the guide probe and WFS pickoff fields is the nominal center of the MODS science field of view.</p>
<p>Queries the individual mechanism controllers for the current position. All positions are stored internally in units of millimeters. </p>

<p class="reference">References <a class="el" href="commands_8c.html#ae0b53dfa6d908dfd8560f7470e8e601b">agw</a>, <a class="el" href="agwutils_8c.html#a7aae70ba43d838257df2d6b9b74e525f">agwToGP()</a>, and <a class="el" href="mlc_8c.html#ad6fb1bd667b43fffab5f089b5effd1cc">positionToShrMem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="commands_8c.html#afad782c4abb40b72bc45da5fed0cdd93">cmd_center()</a>, <a class="el" href="commands_8c.html#ac054c29585178a1cb24aa710ac838389">cmd_focus()</a>, <a class="el" href="commands_8c.html#a20fc57396c588a2a263d9e2ea59ed25f">cmd_foffset()</a>, <a class="el" href="commands_8c.html#ae9ef1b5fbf25715cc45fc7906b05f615">cmd_home()</a>, and <a class="el" href="commands_8c.html#a7344d7ca398862ff787b6fdc16146641">cmd_xy()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
