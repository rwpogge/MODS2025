<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISIS Server: utils.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ISIS Server
   &#160;<span id="projectnumber">Version 2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">utils.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Server utility routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="isisserver_8h_source.html">isisserver.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2c25d1cb53ff3ecae5d0191ca0951746"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a2c25d1cb53ff3ecae5d0191ca0951746">getUTCTime</a> (void)</td></tr>
<tr class="memdesc:a2c25d1cb53ff3ecae5d0191ca0951746"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the UTC time from the system clock.  <a href="utils_8c.html#a2c25d1cb53ff3ecae5d0191ca0951746">More...</a><br /></td></tr>
<tr class="separator:a2c25d1cb53ff3ecae5d0191ca0951746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46cc376aa8e8f88225a3394a71505499"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a46cc376aa8e8f88225a3394a71505499">getFineTime</a> (void)</td></tr>
<tr class="memdesc:a46cc376aa8e8f88225a3394a71505499"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the UTC time to microsecond precision.  <a href="utils_8c.html#a46cc376aa8e8f88225a3394a71505499">More...</a><br /></td></tr>
<tr class="separator:a46cc376aa8e8f88225a3394a71505499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b084bc0ea03de889eff2b593c43001"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a00b084bc0ea03de889eff2b593c43001">getDateTime</a> (void)</td></tr>
<tr class="memdesc:a00b084bc0ea03de889eff2b593c43001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the UTC date and time to microsecond precision as a system timestamp.  <a href="utils_8c.html#a00b084bc0ea03de889eff2b593c43001">More...</a><br /></td></tr>
<tr class="separator:a00b084bc0ea03de889eff2b593c43001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e528d90aa643653c09583afa2ae9a4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a92e528d90aa643653c09583afa2ae9a4">sysTimeStamp</a> (void)</td></tr>
<tr class="memdesc:a92e528d90aa643653c09583afa2ae9a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the elapsed time in sec since UTC 1970-01-01 with microsec precision.  <a href="utils_8c.html#a92e528d90aa643653c09583afa2ae9a4">More...</a><br /></td></tr>
<tr class="separator:a92e528d90aa643653c09583afa2ae9a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46b74e1b911ca7280bd08abc4204a5ba"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a46b74e1b911ca7280bd08abc4204a5ba">noonDateTag</a> (void)</td></tr>
<tr class="memdesc:a46b74e1b911ca7280bd08abc4204a5ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local noon-to-noon date tag in CCYYMMDD format.  <a href="utils_8c.html#a46b74e1b911ca7280bd08abc4204a5ba">More...</a><br /></td></tr>
<tr class="separator:a46b74e1b911ca7280bd08abc4204a5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac0f169a60c54a4e084b1d5f758e695c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aac0f169a60c54a4e084b1d5f758e695c">upperCase</a> (char *str)</td></tr>
<tr class="memdesc:aac0f169a60c54a4e084b1d5f758e695c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a string to all uppercase.  <a href="utils_8c.html#aac0f169a60c54a4e084b1d5f758e695c">More...</a><br /></td></tr>
<tr class="separator:aac0f169a60c54a4e084b1d5f758e695c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c21ae0e7d0d3edaff8bb2d8114d9635"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a4c21ae0e7d0d3edaff8bb2d8114d9635">getArg</a> (char *argStr, int argNum, char *returnStr)</td></tr>
<tr class="memdesc:a4c21ae0e7d0d3edaff8bb2d8114d9635"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract an argument from the command line.  <a href="utils_8c.html#a4c21ae0e7d0d3edaff8bb2d8114d9635">More...</a><br /></td></tr>
<tr class="separator:a4c21ae0e7d0d3edaff8bb2d8114d9635"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Server utility routines. </p>
<p>A suite of basic utility functions, primarily for string and time handling, used by the ISIS server application. <br  />
</p>
<p>Some of these are not used - we'll either ignore that or clean up in the future. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2c25d1cb53ff3ecae5d0191ca0951746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c25d1cb53ff3ecae5d0191ca0951746">&#9670;&nbsp;</a></span>getUTCTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getUTCTime </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the UTC time from the system clock. </p>
<p>Reads the system's UTC time clock and puts date/time information into the system table.</p>
<p>Time info is stored as follows: </p><ul>
<li>isis.dateTag has a date tag in <code>ccyymmdd</code> format </li>
<li>isis.utcDate has the UTC date in ISO8601-compliant <code>CCYY-MM-DD</code> format </li>
<li>isis.utcTime has the UTC time in <code>hh:mm:ss</code> format </li>
</ul>

<p class="reference">References <a class="el" href="structserver.html#a1c10fa97fdd761fb0ef9a9ec036c599e">server::dateTag</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="structserver.html#a774a6bf249791e05cdf13a4d8c971b1e">server::utcDate</a>, and <a class="el" href="structserver.html#a0f5f7c24b11205dd417bf908b6e7b198">server::utcTime</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisserver_8h.html#a3973ef656cb05ec6f064ae96bd239146">initLog()</a>, <a class="el" href="commands_8c.html#a0b6c90731f359a749d70058fdec67de6">isisCommand()</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, and <a class="el" href="interfaces_8c.html#a495217ac039d9c4d2ca75b3e731f5936">openSocket()</a>.</p>

</div>
</div>
<a id="a46cc376aa8e8f88225a3394a71505499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46cc376aa8e8f88225a3394a71505499">&#9670;&nbsp;</a></span>getFineTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* getFineTime </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the UTC time to microsecond precision. </p>
<p>Reads the system's UTC time clock and returns a pointer to a string with the fine-grained UTC time in <code>hh:mm:ss.ssssss</code> format.</p>
<p>Based on gf_time() from Stevens, W.R., 1998, Unix Network Programming, Vol 2, Prentice Hall, Figure 15.6, but I make a string, and restrict the output of seconds to msec rather than usec.</p>
<p>Of course, it may return microsecond precision, microsecond accuracy is quite another thing... </p>

<p class="reference">References <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

</div>
</div>
<a id="a00b084bc0ea03de889eff2b593c43001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00b084bc0ea03de889eff2b593c43001">&#9670;&nbsp;</a></span>getDateTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* getDateTime </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the UTC date and time to microsecond precision as a system timestamp. </p>
<p>Reads the system's UTC time clock and returns a pointer to a string with the fine-grained UTC time in <code>hh:mm:ss.ssssss</code> format.</p>
<p>Based on gf_time() from Stevens, W.R., 1998, Unix Network Programming, Vol 2, Prentice Hall, Figure 15.6, but I make a string, and restrict the output of seconds to msec rather than usec.</p>
<p>Of course, it may return microsecond precision, microsecond accuracy is quite another thing... </p>

<p class="reference">References <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisserver_8h.html#a3973ef656cb05ec6f064ae96bd239146">initLog()</a>, <a class="el" href="commands_8c.html#a0b6c90731f359a749d70058fdec67de6">isisCommand()</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, and <a class="el" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a92e528d90aa643653c09583afa2ae9a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e528d90aa643653c09583afa2ae9a4">&#9670;&nbsp;</a></span>sysTimeStamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sysTimeStamp </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the elapsed time in sec since UTC 1970-01-01 with microsec precision. </p>
<p>Reads the system's time clock and returns a double-precision value with the time in seconds and microseconds since UTC 1970-01-01. This provides us with a fine-grained numerical timestamp for the system.</p>
<p>Of course, it may return microsecond precision, microsecond accuracy is quite another thing. The relative time should be as stable as PC system clocks ever are. </p>

<p class="reference">References <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="clients_8c.html#a524bc0f74f7e82ee3020a1774fdfad39">hostInfo()</a>, <a class="el" href="clients_8c.html#affdaef33a050d4caa221379dea3778cd">printHosts()</a>, and <a class="el" href="clients_8c.html#a50f115c43defbeedccf2329f2f67d947">updateHosts()</a>.</p>

</div>
</div>
<a id="a46b74e1b911ca7280bd08abc4204a5ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46b74e1b911ca7280bd08abc4204a5ba">&#9670;&nbsp;</a></span>noonDateTag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* noonDateTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Local noon-to-noon date tag in CCYYMMDD format. </p>
<p>Convenience function for creating noon-to-noon date tags in the local time zone. If the time is after noon, it uses the current local date. If before noon, it uses <em>yesterday's</em> local date.</p>
<p>This convention is used for "observing day", to avoid the problem with UTC that afternoon calibrations end up in the previous night's logs, or with using local midnight where logs of a night's observing are divided between two "civil day" logs. </p>

<p class="reference">References <a class="el" href="isisserver_8h.html#a4471a9caa133c279c246393e255d6089">SHORT_STR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisserver_8h.html#a3973ef656cb05ec6f064ae96bd239146">initLog()</a>, and <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>.</p>

</div>
</div>
<a id="aac0f169a60c54a4e084b1d5f758e695c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac0f169a60c54a4e084b1d5f758e695c">&#9670;&nbsp;</a></span>upperCase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void upperCase </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a string to all uppercase. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>String to convert to uppercase</td></tr>
  </table>
  </dd>
</dl>
<p>BEWARE: Changes the string being converted! </p>

<p class="reference">Referenced by <a class="el" href="clients_8c.html#a524bc0f74f7e82ee3020a1774fdfad39">hostInfo()</a>, <a class="el" href="commands_8c.html#a0b6c90731f359a749d70058fdec67de6">isisCommand()</a>, <a class="el" href="clients_8c.html#a51029d99516e42b50bf8a7b3b3dd6f5e">isKnownHost()</a>, <a class="el" href="clients_8c.html#affdaef33a050d4caa221379dea3778cd">printHosts()</a>, <a class="el" href="interfaces_8c.html#a2a0827acfe57492012f3e4cdb6e3c530">serialHandler()</a>, <a class="el" href="interfaces_8c.html#a0dfcbfecb48c09ef71ba42573fabadf1">socketHandler()</a>, and <a class="el" href="clients_8c.html#a50f115c43defbeedccf2329f2f67d947">updateHosts()</a>.</p>

</div>
</div>
<a id="a4c21ae0e7d0d3edaff8bb2d8114d9635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c21ae0e7d0d3edaff8bb2d8114d9635">&#9670;&nbsp;</a></span>getArg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getArg </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argStr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>returnStr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract an argument from the command line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argstr</td><td>string containing the argument list </td></tr>
    <tr><td class="paramname">argnum</td><td>number of the argument to extract </td></tr>
    <tr><td class="paramname">retarg</td><td>string to contain the extracted argnum-th argument</td></tr>
  </table>
  </dd>
</dl>
<p>Simple command-line argument parser. Works OK, but will probably replace someday by something fancier of the need arises.</p>
<p>Returns a null (\0) in regarg if the argnum-th argument doesn't exist.</p>
<p>If any stray nulls are found in the string, it replaces them with spaces. </p>

<p class="reference">References <a class="el" href="isisserver_8h.html#af19d48b9f61047a668649a2f9dc317ff">NUL</a>.</p>

<p class="reference">Referenced by <a class="el" href="commands_8c.html#a0b6c90731f359a749d70058fdec67de6">isisCommand()</a>, <a class="el" href="isisserver_8h.html#a7731517bbcb0b2aa2a5f43bd640bd8a9">loadConfig()</a>, <a class="el" href="interfaces_8c.html#a2a0827acfe57492012f3e4cdb6e3c530">serialHandler()</a>, <a class="el" href="interfaces_8c.html#a0dfcbfecb48c09ef71ba42573fabadf1">socketHandler()</a>, and <a class="el" href="interfaces_8c.html#af28ab32ad94422e202107ebd3cc5ed20">ttyHandler()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
