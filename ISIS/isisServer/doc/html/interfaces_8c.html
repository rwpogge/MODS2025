<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISIS Server: interfaces.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ISIS Server
   &#160;<span id="projectnumber">Version 2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">interfaces.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ISIS server interface routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="isisserver_8h_source.html">isisserver.h</a>&quot;</code><br />
<code>#include &lt;readline/readline.h&gt;</code><br />
<code>#include &lt;readline/history.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a495217ac039d9c4d2ca75b3e731f5936"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#a495217ac039d9c4d2ca75b3e731f5936">openSocket</a> (int isisPort)</td></tr>
<tr class="memdesc:a495217ac039d9c4d2ca75b3e731f5936"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open and setup the ISIS server UDP network socket.  <a href="interfaces_8c.html#a495217ac039d9c4d2ca75b3e731f5936">More...</a><br /></td></tr>
<tr class="separator:a495217ac039d9c4d2ca75b3e731f5936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3936e8c5094d3925a008a39b29324206"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#a3936e8c5094d3925a008a39b29324206">closeSocket</a> (int sockFD)</td></tr>
<tr class="memdesc:a3936e8c5094d3925a008a39b29324206"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the ISIS server socket.  <a href="interfaces_8c.html#a3936e8c5094d3925a008a39b29324206">More...</a><br /></td></tr>
<tr class="separator:a3936e8c5094d3925a008a39b29324206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab06d8910c144a436be215d0861828acc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#ab06d8910c144a436be215d0861828acc">initSerialPorts</a> ()</td></tr>
<tr class="memdesc:ab06d8910c144a436be215d0861828acc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the serial ports listed in the server's serial port table.  <a href="interfaces_8c.html#ab06d8910c144a436be215d0861828acc">More...</a><br /></td></tr>
<tr class="separator:ab06d8910c144a436be215d0861828acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110787b8d84538c9f83709e9d125ba3e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#a110787b8d84538c9f83709e9d125ba3e">getSerialInfo</a> (int testFD)</td></tr>
<tr class="memdesc:a110787b8d84538c9f83709e9d125ba3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map a serial port file descriptor onto a serial port table index.  <a href="interfaces_8c.html#a110787b8d84538c9f83709e9d125ba3e">More...</a><br /></td></tr>
<tr class="separator:a110787b8d84538c9f83709e9d125ba3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a9721e8d043b252c2592e01d93b540"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#a69a9721e8d043b252c2592e01d93b540">handShake</a> ()</td></tr>
<tr class="memdesc:a69a9721e8d043b252c2592e01d93b540"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handshake with the clients on serial ports and preset UDP ports.  <a href="interfaces_8c.html#a69a9721e8d043b252c2592e01d93b540">More...</a><br /></td></tr>
<tr class="separator:a69a9721e8d043b252c2592e01d93b540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0827acfe57492012f3e4cdb6e3c530"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#a2a0827acfe57492012f3e4cdb6e3c530">serialHandler</a> (int serialFD)</td></tr>
<tr class="memdesc:a2a0827acfe57492012f3e4cdb6e3c530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle input from server serial ports.  <a href="interfaces_8c.html#a2a0827acfe57492012f3e4cdb6e3c530">More...</a><br /></td></tr>
<tr class="separator:a2a0827acfe57492012f3e4cdb6e3c530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dfcbfecb48c09ef71ba42573fabadf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#a0dfcbfecb48c09ef71ba42573fabadf1">socketHandler</a> (int sockFD)</td></tr>
<tr class="memdesc:a0dfcbfecb48c09ef71ba42573fabadf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle input from a network client socket.  <a href="interfaces_8c.html#a0dfcbfecb48c09ef71ba42573fabadf1">More...</a><br /></td></tr>
<tr class="separator:a0dfcbfecb48c09ef71ba42573fabadf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af28ab32ad94422e202107ebd3cc5ed20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaces_8c.html#af28ab32ad94422e202107ebd3cc5ed20">ttyHandler</a> (char *ttyStr)</td></tr>
<tr class="memdesc:af28ab32ad94422e202107ebd3cc5ed20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle input from the command line (readline callback function)  <a href="interfaces_8c.html#af28ab32ad94422e202107ebd3cc5ed20">More...</a><br /></td></tr>
<tr class="separator:af28ab32ad94422e202107ebd3cc5ed20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ISIS server interface routines. </p>
<p>... description of the ISIS server interfaces ...</p>
<p>Three basic routines are provided for handling input message traffic on the various server interfaces: </p><ul>
<li><a class="el" href="interfaces_8c.html#a2a0827acfe57492012f3e4cdb6e3c530" title="Handle input from server serial ports.">serialHandler()</a> Server serial port input input handler </li>
<li><a class="el" href="interfaces_8c.html#a0dfcbfecb48c09ef71ba42573fabadf1" title="Handle input from a network client socket.">socketHandler()</a> Server UDP network socket input handler </li>
<li><a class="el" href="interfaces_8c.html#af28ab32ad94422e202107ebd3cc5ed20" title="Handle input from the command line (readline callback function)">ttyHandler()</a> Keyboard input at the server console (readline callback) These handlers are designed to be called from within the select() communications multiplexing loop when input is available on the watched file descriptors. </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a495217ac039d9c4d2ca75b3e731f5936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495217ac039d9c4d2ca75b3e731f5936">&#9670;&nbsp;</a></span>openSocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int openSocket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isisPort</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open and setup the ISIS server UDP network socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ISISPort</td><td>Port number on localhost for the server socket. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if errors occurred.</dd></dl>
<p>Creates a UDP socket for the ISIS server applications and sets the file descriptor in the system table. It then binds the socket to the named port on localhost, and stores relevant information in the ISIS system table for future use without having to use thread-unsafe getxxx calls. <br  />
</p>
<p>Errors are reported to stdout by this routine.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="interfaces_8c.html#a3936e8c5094d3925a008a39b29324206" title="Close the ISIS server socket.">closeSocket()</a> </dd></dl>

<p class="reference">References <a class="el" href="isisserver_8h.html#a2c25d1cb53ff3ecae5d0191ca0951746">getUTCTime()</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="structserver.html#ae48f4c3b313f2e24d194ce845a21c63b">server::localHost</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, <a class="el" href="structserver.html#a0cb6c87d8dcf19087e959f185b43a2a9">server::sockFD</a>, <a class="el" href="structserver.html#a49cbbf5c42f854bcebbdbda9431e918e">server::sockPort</a>, <a class="el" href="structserver.html#ae5e2f2f88b9f8417271cf4a9ffbd7f4b">server::startTime</a>, <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>, <a class="el" href="structserver.html#a774a6bf249791e05cdf13a4d8c971b1e">server::utcDate</a>, and <a class="el" href="structserver.html#a0f5f7c24b11205dd417bf908b6e7b198">server::utcTime</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisd_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a3936e8c5094d3925a008a39b29324206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3936e8c5094d3925a008a39b29324206">&#9670;&nbsp;</a></span>closeSocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeSocket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sockFD</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the ISIS server socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sockFD</td><td>File descriptor of the open ISIS server socket (see <a class="el" href="interfaces_8c.html#a495217ac039d9c4d2ca75b3e731f5936" title="Open and setup the ISIS server UDP network socket.">openSocket()</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>Tears down the ISIS server socket and releases the file descriptor. Currently this is little more than a convenience wrapper for close(), but someday it might do more.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="interfaces_8c.html#a495217ac039d9c4d2ca75b3e731f5936" title="Open and setup the ISIS server UDP network socket.">openSocket()</a> </dd></dl>

<p class="reference">Referenced by <a class="el" href="isisd_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="ab06d8910c144a436be215d0861828acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab06d8910c144a436be215d0861828acc">&#9670;&nbsp;</a></span>initSerialPorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int initSerialPorts </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the serial ports listed in the server's serial port table. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of serial ports opened successfully, &lt;0 if any failed.</dd></dl>
<p>Initializes all of the serial ports listed in the server's serial port table (ttyTab struct, defined by entries in the runtime config file). It also attempts to close them first, allowing this function to also be used to re-initialize the ports. One failure is enough to cause an abort. </p>

<p class="reference">References <a class="el" href="structserial.html#a7bedc29a6c68db47a1e9e3e7e9647359">serial::fd</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, <a class="el" href="structserver.html#a1fb612a824bfdbfdee8051e203cb8387">server::numSerial</a>, <a class="el" href="isisd_8c.html#abaf76ce78c6223f91d80fdafbf19cd63">ttyTab</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisd_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a110787b8d84538c9f83709e9d125ba3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a110787b8d84538c9f83709e9d125ba3e">&#9670;&nbsp;</a></span>getSerialInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getSerialInfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>testFD</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map a serial port file descriptor onto a serial port table index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">testFD</td><td>Serial port file descriptor to map </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The serial port table index of the test file descriptor if present, otherwise it returns ERR_UNKNOWN_FD if no match is found.</dd></dl>
<p>Searches for <code>testFD</code> in the server's active serial port table, and returns the index of the port table entry if found. The serial port table is the ttyTab struct defined in the <a class="el" href="isisserver_8h.html" title="ISIS server application main header.">isisserver.h</a> header file. </p>

<p class="reference">References <a class="el" href="isisserver_8h.html#afd4309af9989c38362df1c30b01f5023">ERR_UNKNOWN_FD</a>, <a class="el" href="isisserver_8h.html#abbae560d612d74cd2d870a0b22a5517d">MAXSERIAL</a>, and <a class="el" href="isisd_8c.html#abaf76ce78c6223f91d80fdafbf19cd63">ttyTab</a>.</p>

<p class="reference">Referenced by <a class="el" href="interfaces_8c.html#a2a0827acfe57492012f3e4cdb6e3c530">serialHandler()</a>.</p>

</div>
</div>
<a id="a69a9721e8d043b252c2592e01d93b540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69a9721e8d043b252c2592e01d93b540">&#9670;&nbsp;</a></span>handShake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handShake </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handshake with the clients on serial ports and preset UDP ports. </p>
<p>Sends a "&gt;AL PING" message to all open serial ports and all preset UDP ports. This is a blind broadcast that should lead to "PONG"s back from any ISIS clients on the serial lines or connected to the UDP socket ports.</p>
<p>This is a placeholder that gives us minimal IMPv2 software handshaking until we can work with the system some and work out better procedures.</p>
<p>All strings transmitted to raw ports must be in proper IMPv2-conformal format, terminated by \r (ASCII 13). </p>

<p class="reference">References <a class="el" href="structserial.html#a7bedc29a6c68db47a1e9e3e7e9647359">serial::fd</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, <a class="el" href="isisserver_8h.html#a1edd1143db991c08ba230895b372dfa1">MED_STR_SIZE</a>, <a class="el" href="structserver.html#aacbcd5e53a3c7b043610ab1e8b5eac3b">server::numPreset</a>, <a class="el" href="structserver.html#a1fb612a824bfdbfdee8051e203cb8387">server::numSerial</a>, <a class="el" href="structserver.html#acbe78cdc6cc95d85c5b8e6831a8e861e">server::serverID</a>, <a class="el" href="structserver.html#a0cb6c87d8dcf19087e959f185b43a2a9">server::sockFD</a>, <a class="el" href="isisd_8c.html#abaf76ce78c6223f91d80fdafbf19cd63">ttyTab</a>, <a class="el" href="isisd_8c.html#a89d3745e81a67aa20a70b2fb9be8fae3">udpTab</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisd_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a2a0827acfe57492012f3e4cdb6e3c530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0827acfe57492012f3e4cdb6e3c530">&#9670;&nbsp;</a></span>serialHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>serialFD</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle input from server serial ports. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serialFD</td><td>File descriptor of the serial port with input ready.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads a line of input from the specified serial port file descriptor, and spits the message into components: source host ID, destination host ID, and message body (including message type).</p>
<p>If the source and destination are valid, and the message is not blank or malformed, it then passes the message off to HandleMessage() to route the message to its intended recipient.</p>
<p>When generating IMPv2 messages for direct transmission through the server, the strings must be terminated with return (\r = ASCII 13) not a newline (\n = ASCII 10).</p>
<p>This function is designed to be invoked by a select() loop that watches particular file descriptors. See <a class="el" href="main_8c.html" title="ISIS server main program and I/O event handler.">main.c</a> for how it is implemented. </p>

<p class="reference">References <a class="el" href="isisserver_8h.html#ac286e1243ab6be2c950c277e5e1377f9">BROADCAST</a>, <a class="el" href="isisserver_8h.html#a8e3c67c26c835bc4e20021e5a3a83c42">ERR_HOSTS_FULL</a>, <a class="el" href="isisserver_8h.html#afd4309af9989c38362df1c30b01f5023">ERR_UNKNOWN_FD</a>, <a class="el" href="isisserver_8h.html#af164aa4b564a93b4587b4602f9637162">ERR_UNKNOWN_HOST</a>, <a class="el" href="isisserver_8h.html#aba102ee58cc9e4a8b1a2429f7e3b632e">getArg()</a>, <a class="el" href="interfaces_8c.html#a110787b8d84538c9f83709e9d125ba3e">getSerialInfo()</a>, <a class="el" href="isisserver_8h.html#afe107bddbb05e66ba9dba28bdeb7a736">handleMessage()</a>, <a class="el" href="isisserver_8h.html#a10d1b23c79ee129875e95012b8863b92">IMPv2_HOST_SIZE</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#af6b9772636617ee4660660fbcab9f631">ISIS_MSGSIZE</a>, <a class="el" href="isisserver_8h.html#abff6f76b9ef26ab43a3c2ae256e1974a">ISIS_SERVER</a>, <a class="el" href="clients_8c.html#a51029d99516e42b50bf8a7b3b3dd6f5e">isKnownHost()</a>, <a class="el" href="structserver.html#ab0704958386b2a2daecfb1f8d028fc2e">server::isVerbose</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, <a class="el" href="isisserver_8h.html#a1edd1143db991c08ba230895b372dfa1">MED_STR_SIZE</a>, <a class="el" href="isisserver_8h.html#a12f1bdfd6ee5a8596083c532ea9be3a2">sendMessage()</a>, <a class="el" href="isisserver_8h.html#aae3f0b4211ba45d265973d40ccbb5fd1">SERIAL</a>, <a class="el" href="structserver.html#acbe78cdc6cc95d85c5b8e6831a8e861e">server::serverID</a>, <a class="el" href="isisd_8c.html#abaf76ce78c6223f91d80fdafbf19cd63">ttyTab</a>, <a class="el" href="clients_8c.html#a50f115c43defbeedccf2329f2f67d947">updateHosts()</a>, <a class="el" href="isisserver_8h.html#ac59fb73543cd37053429467f9356717f">upperCase()</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisd_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a0dfcbfecb48c09ef71ba42573fabadf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dfcbfecb48c09ef71ba42573fabadf1">&#9670;&nbsp;</a></span>socketHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void socketHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sockFD</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle input from a network client socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sockFD</td><td>File descriptor of the server's socket.</td></tr>
  </table>
  </dd>
</dl>
<p>Read a line of input from the specified network socket file descriptor, and parse the message into components (source host ID, destination host ID, and message body).</p>
<p>If the source and destination are valid, and the message is not blank or malformed, it then passes control off to <a class="el" href="isisserver_8h.html#afe107bddbb05e66ba9dba28bdeb7a736" title="Handle messages received by the ISIS server.">handleMessage()</a> to do the dirty work. This may permit us to enable multithreading in the future.</p>
<p>When generating IMPv2-compliant messages, the strings must be terminated with return (\r = ASCII 13) not a newline (\n = ASCII 10).</p>
<p>This function is designed to be invoked by a select() loop that watches particular file descriptors. See <a class="el" href="main_8c.html" title="ISIS server main program and I/O event handler.">main.c</a> for how it is implemented. </p>

<p class="reference">References <a class="el" href="isisserver_8h.html#a896538c6c44ade4695fbcecf857dae48">BIG_STR_SIZE</a>, <a class="el" href="isisserver_8h.html#ac286e1243ab6be2c950c277e5e1377f9">BROADCAST</a>, <a class="el" href="isisserver_8h.html#a8e3c67c26c835bc4e20021e5a3a83c42">ERR_HOSTS_FULL</a>, <a class="el" href="isisserver_8h.html#af164aa4b564a93b4587b4602f9637162">ERR_UNKNOWN_HOST</a>, <a class="el" href="isisserver_8h.html#aba102ee58cc9e4a8b1a2429f7e3b632e">getArg()</a>, <a class="el" href="isisserver_8h.html#afe107bddbb05e66ba9dba28bdeb7a736">handleMessage()</a>, <a class="el" href="isisserver_8h.html#a10d1b23c79ee129875e95012b8863b92">IMPv2_HOST_SIZE</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#af6b9772636617ee4660660fbcab9f631">ISIS_MSGSIZE</a>, <a class="el" href="isisserver_8h.html#abff6f76b9ef26ab43a3c2ae256e1974a">ISIS_SERVER</a>, <a class="el" href="clients_8c.html#a51029d99516e42b50bf8a7b3b3dd6f5e">isKnownHost()</a>, <a class="el" href="structserver.html#ab0704958386b2a2daecfb1f8d028fc2e">server::isVerbose</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, <a class="el" href="isisserver_8h.html#a12f1bdfd6ee5a8596083c532ea9be3a2">sendMessage()</a>, <a class="el" href="structserver.html#acbe78cdc6cc95d85c5b8e6831a8e861e">server::serverID</a>, <a class="el" href="isisserver_8h.html#aff55fe551a9992a54ec54621c524d0a4">SOCKET</a>, <a class="el" href="clients_8c.html#a50f115c43defbeedccf2329f2f67d947">updateHosts()</a>, <a class="el" href="isisserver_8h.html#ac59fb73543cd37053429467f9356717f">upperCase()</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="isisd_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="af28ab32ad94422e202107ebd3cc5ed20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af28ab32ad94422e202107ebd3cc5ed20">&#9670;&nbsp;</a></span>ttyHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ttyHandler </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ttyStr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle input from the command line (readline callback function) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ttyStr</td><td>pointer to the text returned by readline()</td></tr>
  </table>
  </dd>
</dl>
<p>This is the callback for readline() that lets our cli make use of the GNU readline and history mechanism (arrow keys and command-line editing). The callback is installed using the <code>rl_callback_hander_install()</code> function of the readline library.</p>
<p>Once we get an error-free string we can use, we then try to interpret it. This is the main cli handler for the server.</p>
<p>When generating IMPv2 messages for direct transmission onto the system, the strings must be terminated with return (\r = ASCII 13) not a newline (\n = ASCII 10). </p>

<p class="reference">References <a class="el" href="isisserver_8h.html#a896538c6c44ade4695fbcecf857dae48">BIG_STR_SIZE</a>, <a class="el" href="isisserver_8h.html#ac286e1243ab6be2c950c277e5e1377f9">BROADCAST</a>, <a class="el" href="isisserver_8h.html#a84f23e6e062badcef82b8a3f536a589f">broadcastMessage()</a>, <a class="el" href="isisserver_8h.html#af164aa4b564a93b4587b4602f9637162">ERR_UNKNOWN_HOST</a>, <a class="el" href="isisserver_8h.html#aba102ee58cc9e4a8b1a2429f7e3b632e">getArg()</a>, <a class="el" href="isisserver_8h.html#afe107bddbb05e66ba9dba28bdeb7a736">handleMessage()</a>, <a class="el" href="isisserver_8h.html#a10d1b23c79ee129875e95012b8863b92">IMPv2_HOST_SIZE</a>, <a class="el" href="isisd_8c.html#a87937aa5e68dbe69f06e693a4b9b87a6">isis</a>, <a class="el" href="isisserver_8h.html#a9b5048a4db8478ffeb2291554c4861f8">isis_FALSE</a>, <a class="el" href="isisserver_8h.html#af6b9772636617ee4660660fbcab9f631">ISIS_MSGSIZE</a>, <a class="el" href="isisserver_8h.html#abff6f76b9ef26ab43a3c2ae256e1974a">ISIS_SERVER</a>, <a class="el" href="isisserver_8h.html#a9e9b5011a69186adb0e47655a6fec967">isis_TRUE</a>, <a class="el" href="commands_8c.html#a0b6c90731f359a749d70058fdec67de6">isisCommand()</a>, <a class="el" href="clients_8c.html#a51029d99516e42b50bf8a7b3b3dd6f5e">isKnownHost()</a>, <a class="el" href="structserver.html#ab0704958386b2a2daecfb1f8d028fc2e">server::isVerbose</a>, <a class="el" href="structserver.html#a3b4e3cafc3b1f454463c5bfc0104983a">server::keepGoing</a>, <a class="el" href="isisserver_8h.html#a50f178fc99e82ee6564cfcd5792d5935">logMessage()</a>, <a class="el" href="isisserver_8h.html#a1edd1143db991c08ba230895b372dfa1">MED_STR_SIZE</a>, <a class="el" href="isisserver_8h.html#a42316d489e809e8faf0bf766fe7a1039">MSG_REPLY</a>, <a class="el" href="commands_8c.html#a0d20b69b0ad703df78459e1033d5c1d4">printHelp()</a>, <a class="el" href="clients_8c.html#affdaef33a050d4caa221379dea3778cd">printHosts()</a>, <a class="el" href="commands_8c.html#a2dbaf5580b5305d54cff6848ae7deb30">printInfo()</a>, <a class="el" href="isisserver_8h.html#a12f1bdfd6ee5a8596083c532ea9be3a2">sendMessage()</a>, <a class="el" href="structserver.html#acbe78cdc6cc95d85c5b8e6831a8e861e">server::serverID</a>, and <a class="el" href="structserver.html#afd5985cc10d0f6b5681a0f6028e34352">server::useCLI</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
